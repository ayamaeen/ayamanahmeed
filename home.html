<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…Ø¯ÙˆÙ†ØªÙŠ | Blog</title>
  <meta name="description" content="Ù…Ø¯ÙˆÙ†Ø© Ø´Ø®ØµÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù…Ø¹ Ø¨Ø­Ø«ØŒ ØªØµÙ†ÙŠÙØ§ØªØŒ ØªØ§ØºØ§ØªØŒ ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠØŒ ÙˆØ¥Ø¯Ø§Ø±Ø© Ù…Ù‚Ø§Ù„Ø§Øª Ù…Ø­Ù„ÙŠÙ‹Ø§." />
  <style>
    :root{
      --bg:#0b1220; --card:#0f1a2e; --muted:#96a3b7; --text:#eef3ff; --brand:#7c5cff;
      --border: rgba(255,255,255,.08);
      --shadow: 0 10px 30px rgba(0,0,0,.25);
      --radius: 18px;
      --focus: 0 0 0 3px rgba(124,92,255,.25);
      --btn:#162645;
      --btn2:#1a2d52;
      --danger:#ff4d4d;
      --ok:#35d07f;
    }
    [data-theme="light"]{
      --bg:#f5f7fb; --card:#ffffff; --muted:#5b6575; --text:#111827; --brand:#5b3df0;
      --border: rgba(17,24,39,.10);
      --shadow: 0 10px 30px rgba(17,24,39,.10);
      --btn:#eef2ff;
      --btn2:#e6e9ff;
      --danger:#e11d48;
      --ok:#16a34a;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0; font-family: system-ui, -apple-system, "Segoe UI", Tahoma, Arial, sans-serif;
      background: radial-gradient(1200px 600px at 20% 0%, rgba(124,92,255,.18), transparent 60%),
                  radial-gradient(1200px 600px at 80% 20%, rgba(53,208,127,.12), transparent 60%),
                  var(--bg);
      color: var(--text);
    }
    a{ color: inherit; text-decoration: none; }
    .container{ max-width:1200px; margin:0 auto; padding: 22px 16px 60px; }
    header{
      position: sticky; top:0; z-index: 20;
      backdrop-filter: blur(10px);
      background: color-mix(in srgb, var(--bg) 70%, transparent);
      border-bottom: 1px solid var(--border);
    }
    .topbar{ display:flex; gap:12px; align-items:center; justify-content:space-between; padding: 14px 16px; max-width:1200px; margin:0 auto; }
    .brand{ display:flex; gap:10px; align-items:center; }
    .logo{
      width:38px; height:38px; border-radius: 14px;
      background: linear-gradient(135deg, var(--brand), color-mix(in srgb, var(--brand) 10%, var(--ok)));
      box-shadow: var(--shadow);
    }
    .brand h1{ margin:0; font-size: 16px; }
    .brand p{ margin:0; font-size:12px; color:var(--muted); }
    .actions{ display:flex; gap:10px; align-items:center; }
    button, .chip, input, select, textarea{
      font: inherit;
    }
    .btn{
      border:1px solid var(--border);
      background: var(--btn);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 14px;
      cursor:pointer;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
    }
    .btn:hover{ background: var(--btn2); }
    .btn:active{ transform: scale(.98); }
    .btn.primary{
      border-color: color-mix(in srgb, var(--brand) 55%, var(--border));
      background: color-mix(in srgb, var(--brand) 20%, var(--btn));
    }
    .btn.danger{
      border-color: color-mix(in srgb, var(--danger) 45%, var(--border));
      background: color-mix(in srgb, var(--danger) 14%, var(--btn));
    }
    .btn:focus, input:focus, select:focus, textarea:focus{ outline:none; box-shadow: var(--focus); }
    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 16px;
      margin-top: 18px;
    }
    @media (max-width: 980px){ .grid{ grid-template-columns: 1fr; } }

    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    /* Filters */
    .filters{ padding: 14px; display:grid; gap: 10px; }
    .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .field{ flex:1; min-width: 210px; position: relative; }
    input[type="search"], input[type="text"], input[type="url"], select, textarea{
      width:100%;
      padding: 11px 12px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: color-mix(in srgb, var(--card) 85%, var(--bg));
      color: var(--text);
    }
    textarea{ min-height: 140px; resize: vertical; }
    .hint{ font-size:12px; color:var(--muted); }
    .chips{ display:flex; gap: 8px; flex-wrap:wrap; }
    .chip{
      display:inline-flex; align-items:center; gap:6px;
      border:1px solid var(--border);
      background: color-mix(in srgb, var(--card) 85%, var(--bg));
      padding: 8px 10px;
      border-radius: 999px;
      cursor:pointer;
      user-select:none;
      font-size: 13px;
      color: var(--muted);
    }
    .chip.active{
      color: var(--text);
      border-color: color-mix(in srgb, var(--brand) 45%, var(--border));
      background: color-mix(in srgb, var(--brand) 12%, var(--card));
    }

    /* List */
    .list{ padding: 14px; }
    .list-head{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; margin-bottom: 10px;
    }
    .list-head h2{ margin:0; font-size: 16px; }
    .count{ color: var(--muted); font-size: 13px; }
    .post{
      padding: 14px;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: color-mix(in srgb, var(--card) 90%, var(--bg));
      display:grid;
      gap: 8px;
      margin-bottom: 10px;
    }
    .post:hover{ border-color: color-mix(in srgb, var(--brand) 25%, var(--border)); }
    .meta{ display:flex; gap:10px; flex-wrap:wrap; color: var(--muted); font-size: 12px; }
    .title{ font-size: 18px; font-weight: 750; margin:0; line-height:1.4; }
    .excerpt{ margin:0; color: color-mix(in srgb, var(--text) 70%, var(--muted)); line-height:1.8; }
    .tag{
      display:inline-flex;
      border:1px solid var(--border);
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 12px;
      color: var(--muted);
    }
    .post-actions{ display:flex; gap: 8px; flex-wrap:wrap; margin-top: 6px; }
    .post-actions .btn{ padding: 8px 10px; border-radius: 12px; font-size: 13px; }

    /* Sidebar */
    aside{ padding: 14px; }
    .side-block{ padding: 12px; border-radius: 16px; border:1px solid var(--border); background: color-mix(in srgb, var(--card) 90%, var(--bg)); margin-bottom: 10px; }
    .side-block h3{ margin: 0 0 10px; font-size: 14px; }
    .side-item{ display:flex; gap:10px; align-items:flex-start; justify-content:space-between; padding: 10px 0; border-top: 1px dashed var(--border); }
    .side-item:first-of-type{ border-top: none; padding-top:0; }
    .side-item a{ color: var(--text); font-size: 13px; line-height:1.6; }
    .side-item span{ color: var(--muted); font-size: 12px; white-space: nowrap; }
    .footer{ margin-top: 18px; color: var(--muted); font-size: 12px; text-align:center; }

    /* Pagination */
    .pager{ display:flex; gap: 8px; justify-content:center; align-items:center; padding: 14px; }
    .pager .btn{ padding: 8px 10px; }
    .pager .pageinfo{ color: var(--muted); font-size: 13px; }

    /* Modal */
    .modal-backdrop{
      position: fixed; inset:0; background: rgba(0,0,0,.55);
      display:none; align-items:center; justify-content:center; padding: 18px;
      z-index: 40;
    }
    .modal{
      width: min(860px, 100%);
      border-radius: 18px;
      background: var(--card);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    .modal header{
      position: unset; backdrop-filter: none;
      background: transparent;
      border-bottom: 1px solid var(--border);
    }
    .modal .modal-top{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      padding: 14px;
    }
    .modal .modal-top h3{ margin:0; font-size: 15px; }
    .modal .content{ padding: 14px; display:grid; gap: 10px; }
    .two{ display:grid; gap: 10px; grid-template-columns: 1fr 1fr; }
    @media (max-width: 800px){ .two{ grid-template-columns: 1fr; } }
    .modal .bar{ display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap; padding: 14px; border-top:1px solid var(--border); }

    /* Reader */
    .reader{ padding: 14px; }
    .reader h2{ margin: 0 0 6px; font-size: 22px; line-height: 1.4; }
    .reader .content{
      margin-top: 10px;
      line-height: 2;
      color: color-mix(in srgb, var(--text) 86%, var(--muted));
      white-space: pre-wrap;
    }
    .reader .toolrow{ display:flex; gap:10px; flex-wrap:wrap; margin-top: 12px; }
    .hr{ height:1px; background: var(--border); margin: 12px 0; }

    /* Comments */
    .comments h3{ margin: 0 0 10px; font-size: 14px; }
    .comment{ border:1px solid var(--border); border-radius: 14px; padding: 10px; margin-bottom: 8px; background: color-mix(in srgb, var(--card) 90%, var(--bg)); }
    .comment .cmeta{ display:flex; gap:10px; justify-content:space-between; color:var(--muted); font-size: 12px; }
    .comment p{ margin: 8px 0 0; line-height:1.9; }
    .toast{
      position: fixed; bottom: 14px; left: 14px;
      background: var(--card);
      border:1px solid var(--border);
      border-radius: 14px;
      padding: 10px 12px;
      box-shadow: var(--shadow);
      color: var(--text);
      display:none;
      z-index: 60;
    }
  </style>
</head>

<body>
<header>
  <div class="topbar">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>Ù…Ø¯ÙˆÙ†ØªÙŠ Ø§Ù„ØªÙ‚Ù†ÙŠØ©</h1>
        <p>Ù…Ù‚Ø§Ù„Ø§Øª â€¢ Ø´Ø¨ÙƒØ§Øª â€¢ Ø£Ù…Ù† Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ</p>
      </div>
    </div>
    <div class="actions">
      <button class="btn" id="btnTheme" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹">ğŸŒ™/â˜€ï¸</button>
      <button class="btn primary" id="btnNew">+ Ù…Ù‚Ø§Ù„ Ø¬Ø¯ÙŠØ¯</button>
      <button class="btn" id="btnReset" title="Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
    </div>
  </div>
</header>

<div class="container">
  <div class="grid">
    <!-- Main -->
    <main class="card">
      <!-- Filters -->
      <section class="filters">
        <div class="row">
          <div class="field">
            <input id="q" type="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù‚Ø§Ù„â€¦ (Ø§Ù„Ø¹Ù†ÙˆØ§Ù†/Ø§Ù„Ù…Ø­ØªÙˆÙ‰/Ø§Ù„ØªØ§ØºØ§Øª)" autocomplete="off" />
            <div class="hint" style="margin-top:6px;">Ù†ØµÙŠØ­Ø©: Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ù…Ø«Ù„: firewall Ø£Ùˆ pentest</div>
          </div>
          <div class="field" style="max-width:220px;">
            <select id="sort">
              <option value="newest">Ø§Ù„Ø£Ø­Ø¯Ø«</option>
              <option value="oldest">Ø§Ù„Ø£Ù‚Ø¯Ù…</option>
              <option value="title">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (Ø£-ÙŠ)</option>
            </select>
          </div>
          <div class="field" style="max-width:210px;">
            <select id="category">
              <option value="">ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>
            </select>
          </div>
        </div>

        <div class="row" style="justify-content:space-between;">
          <div class="chips" id="tagChips" aria-label="Ø§Ù„ØªØ§ØºØ§Øª"></div>
          <div class="row">
            <div class="hint" id="activeFilters"></div>
          </div>
        </div>
      </section>

      <!-- Reader (single post) -->
      <section class="reader" id="reader" style="display:none;">
        <div class="meta" id="readerMeta"></div>
        <h2 id="readerTitle"></h2>
        <div class="chips" id="readerTags" style="margin: 8px 0 0;"></div>
        <div class="content" id="readerBody"></div>

        <div class="toolrow">
          <button class="btn" id="btnBack">â† Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
          <button class="btn" id="btnShare">ğŸ”— Ù†Ø³Ø® Ø±Ø§Ø¨Ø·</button>
          <a class="btn" id="shareX" target="_blank" rel="noopener">Ù…Ø´Ø§Ø±ÙƒØ© X</a>
          <a class="btn" id="shareFB" target="_blank" rel="noopener">Ù…Ø´Ø§Ø±ÙƒØ© Facebook</a>
          <a class="btn" id="shareWA" target="_blank" rel="noopener">Ù…Ø´Ø§Ø±ÙƒØ© WhatsApp</a>
          <button class="btn primary" id="btnEdit">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
          <button class="btn danger" id="btnDelete">ğŸ—‘ï¸ Ø­Ø°Ù</button>
        </div>

        <div class="hr"></div>

        <section class="comments">
          <h3>Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</h3>
          <div class="hint" style="margin-bottom:10px;">Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª ØªÙØ­ÙØ¸ Ù…Ø­Ù„ÙŠÙ‹Ø§ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ.</div>
          <div id="commentList"></div>

          <div class="two" style="margin-top:10px;">
            <div class="field"><input id="cName" type="text" placeholder="Ø§Ø³Ù…Ùƒ" /></div>
            <div class="field"><input id="cEmail" type="text" placeholder="Ø¨Ø±ÙŠØ¯Ùƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" /></div>
          </div>
          <div class="field" style="margin-top:10px;">
            <textarea id="cText" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒâ€¦"></textarea>
          </div>
          <div class="row" style="justify-content:flex-end;">
            <button class="btn primary" id="btnAddComment">Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ‚</button>
          </div>
        </section>
      </section>

      <!-- List -->
      <section class="list" id="list">
        <div class="list-head">
          <h2>Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª</h2>
          <div class="count" id="count"></div>
        </div>
        <div id="posts"></div>
        <div class="pager" id="pager"></div>
      </section>
    </main>

    <!-- Sidebar -->
    <aside class="card">
      <div class="side-block">
        <h3>Ø¹Ù† Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©</h3>
        <div class="hint" style="line-height:1.9;">
          Ù…Ø³Ø§Ø­Ø© Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø®Ø¨Ø±Ø§Øª Ø§Ù„Ø´Ø¨ÙƒØ§Øª ÙˆØ§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ.  
          Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø§Ù„Ø¨ ÙŠØ¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø³ÙŠØ±ÙØ± ÙˆÙŠØ®Ø²Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠÙ‹Ø§.
        </div>
      </div>

      <div class="side-block">
        <h3>Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª</h3>
        <div id="latest"></div>
      </div>

      <div class="side-block">
        <h3>Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</h3>
        <div class="chips" id="catChips"></div>
      </div>

      <div class="side-block">
        <h3>Ø§Ù„ØªØ§ØºØ§Øª Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‹Ø§</h3>
        <div class="chips" id="topTags"></div>
      </div>

      <div class="side-block">
        <h3>Ø®ÙŠØ§Ø±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</h3>
        <div class="row" style="justify-content:space-between;">
          <a class="btn" href="#" id="btnExport">ØªØµØ¯ÙŠØ± JSON</a>
          <label class="btn" style="cursor:pointer;">
            Ø§Ø³ØªÙŠØ±Ø§Ø¯ JSON
            <input type="file" id="importFile" accept="application/json" hidden>
          </label>
        </div>
        <div class="hint" style="margin-top:8px;">Ù„ØªÙ†Ù‚Ù„ Ù…Ù‚Ø§Ù„Ø§ØªÙƒ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©.</div>
      </div>

      <div class="footer">
        Â© <span id="year"></span> â€” Ù‚Ø§Ù„Ø¨ Ù…Ø¯ÙˆÙ†Ø© HTML (LocalStorage)
      </div>
    </aside>
  </div>
</div>

<!-- Modal: New/Edit -->
<div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true">
  <div class="modal">
    <header>
      <div class="modal-top">
        <h3 id="modalTitle">Ù…Ù‚Ø§Ù„ Ø¬Ø¯ÙŠØ¯</h3>
        <button class="btn" id="btnClose">âœ•</button>
      </div>
    </header>

    <div class="content">
      <div class="field">
        <input id="fTitle" type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‚Ø§Ù„" />
      </div>
      <div class="two">
        <div class="field">
          <select id="fCategory"></select>
          <div class="hint" style="margin-top:6px;">Ø§Ø®ØªØ± ØªØµÙ†ÙŠÙÙ‹Ø§ Ø£Ùˆ Ø§ÙƒØªØ¨ ØªØµÙ†ÙŠÙÙ‹Ø§ Ø¬Ø¯ÙŠØ¯Ù‹Ø§ ÙÙŠ Ø§Ù„Ø­Ù‚Ù„ Ø¨Ø§Ù„Ø£Ø³ÙÙ„.</div>
        </div>
        <div class="field">
          <input id="fCategoryNew" type="text" placeholder="ØªØµÙ†ÙŠÙ Ø¬Ø¯ÙŠØ¯ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" />
        </div>
      </div>
      <div class="two">
        <div class="field">
          <input id="fTags" type="text" placeholder="ØªØ§ØºØ§Øª Ù…ÙØµÙˆÙ„Ø© Ø¨ÙÙˆØ§ØµÙ„: firewall, vpn, pentest" />
        </div>
        <div class="field">
          <input id="fCover" type="url" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" />
        </div>
      </div>
      <div class="field">
        <textarea id="fBody" placeholder="Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù‚Ø§Ù„â€¦ ÙŠÙ…ÙƒÙ†Ùƒ ÙƒØªØ§Ø¨Ø© Ù†Øµ Ø·ÙˆÙŠÙ„ Ù‡Ù†Ø§."></textarea>
      </div>
      <div class="hint">Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ù„Ù„Ù…Ù‚Ø§Ù„ Ù…Ø«Ù„: #post=ID</div>
    </div>

    <div class="bar">
      <button class="btn" id="btnPreview">ğŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø©</button>
      <button class="btn primary" id="btnSave">ğŸ’¾ Ø­ÙØ¸</button>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
/* =========================
   Storage + Seed Data
========================= */
const KEY = "blog_posts_v1";
const KEY_THEME = "blog_theme_v1";
const KEY_COMMENTS = "blog_comments_v1";

const seed = [
  {
    id: cryptoRandomId(),
    title: "Ù…Ù‚Ø¯Ù…Ø© Ø³Ø±ÙŠØ¹Ø© Ø¹Ù† Firewalls ÙˆØ£Ù†ÙˆØ§Ø¹Ù‡Ø§",
    category: "Ø£Ù…Ù† Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ",
    tags: ["firewall","network-security","blue-team"],
    cover: "",
    body:
`Ø§Ù„Ø¬Ø¯Ø§Ø± Ø§Ù„Ù†Ø§Ø±ÙŠ (Firewall) Ù‡Ùˆ Ø®Ø· Ø¯ÙØ§Ø¹ Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨ÙŠÙ† Ø§Ù„Ø´Ø¨ÙƒØ§Øª.

**Ø£Ù†ÙˆØ§Ø¹ Ø´Ø§Ø¦Ø¹Ø©:**
- Packet Filtering
- Stateful Inspection
- Next-Gen Firewall (NGFW)

Ø§Ø¨Ø¯Ø£ Ø¨ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª (Policies) Ø«Ù… Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø³Ø¬Ù„Ø§Øª (Logs) Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø±.`,
    createdAt: Date.now() - 1000*60*60*24*6
  },
  {
    id: cryptoRandomId(),
    title: "Ø£Ø³Ø§Ø³ÙŠØ§Øª ØªØµÙ…ÙŠÙ… Ø´Ø¨ÙƒØ© ØµØºÙŠØ±Ø© (Small Office)",
    category: "Ø´Ø¨ÙƒØ§Øª",
    tags: ["network-design","switching","routing"],
    cover: "",
    body:
`Ù‚Ø¨Ù„ Ø´Ø±Ø§Ø¡ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©ØŒ Ø§Ø±Ø³Ù… Ù…Ø®Ø·Ø·Ù‹Ø§ ÙˆØ§Ø¶Ø­Ù‹Ø§:
- Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
- Ø§Ø­ØªÙŠØ§Ø¬ Ø§Ù„Ù€ Wi-Fi
- VLANs
- Ù†Ù‚Ø§Ø· Ø§Ù„ÙØµÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø¶ÙŠÙˆÙ ÙˆØ§Ù„Ù…ÙˆØ¸ÙÙŠÙ†

Ø«Ù… Ø§Ø®ØªØ¨Ø± Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ®Ø·Ø· Ù„Ù„ØªÙˆØ³Ø¹.`,
    createdAt: Date.now() - 1000*60*60*24*3
  },
  {
    id: cryptoRandomId(),
    title: "Ù…Ø§Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ù…Ø¨Ø¯Ø£ Ø£Ù‚Ù„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª (Least Privilege)ØŸ",
    category: "Ø£ÙØ¶Ù„ Ù…Ù…Ø§Ø±Ø³Ø§Øª",
    tags: ["iam","least-privilege","security"],
    cover: "",
    body:
`Ø£Ø¹Ø·Ù ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù…/Ø®Ø¯Ù…Ø© Ø£Ù‚Ù„ Ù‚Ø¯Ø± Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù„Ø§Ø²Ù…Ø© Ù„Ù„Ø¹Ù…Ù„ ÙÙ‚Ø·.
Ù‡Ø°Ø§ ÙŠÙ‚Ù„Ù„ ØªØ£Ø«ÙŠØ± Ø£ÙŠ Ø§Ø®ØªØ±Ø§Ù‚ Ø£Ùˆ Ø®Ø·Ø£ Ø¨Ø´Ø±ÙŠ.

Ø§Ø¨Ø¯Ø£ Ø¨Ù€:
- Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¯ÙˆØ±ÙŠÙ‹Ø§
- Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
- ØªØ·Ø¨ÙŠÙ‚ MFA`,
    createdAt: Date.now() - 1000*60*60*24*1
  }
];

function loadPosts(){
  const raw = localStorage.getItem(KEY);
  if(!raw){
    localStorage.setItem(KEY, JSON.stringify(seed));
    return structuredClone(seed);
  }
  try { return JSON.parse(raw) || []; } catch { return []; }
}
function savePosts(posts){
  localStorage.setItem(KEY, JSON.stringify(posts));
}
function loadComments(){
  const raw = localStorage.getItem(KEY_COMMENTS);
  if(!raw) return {};
  try { return JSON.parse(raw) || {}; } catch { return {}; }
}
function saveComments(map){
  localStorage.setItem(KEY_COMMENTS, JSON.stringify(map));
}

/* =========================
   State
========================= */
let posts = loadPosts();
let commentsMap = loadComments();

const state = {
  q: "",
  category: "",
  tag: "",
  sort: "newest",
  page: 1,
  perPage: 5,
  mode: "list",      // list | reader
  currentId: null,
  editingId: null
};

/* =========================
   Helpers
========================= */
function cryptoRandomId(){
  // simple and safe-enough id for local use
  return (crypto?.randomUUID?.() || ("id-" + Math.random().toString(16).slice(2) + Date.now().toString(16)));
}
function fmtDate(ts){
  const d = new Date(ts);
  return d.toLocaleDateString("ar-IQ", { year:"numeric", month:"short", day:"2-digit" });
}
function escapeHtml(s){
  return (s||"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;");
}
function toast(msg){
  const t = document.getElementById("toast");
  t.textContent = msg;
  t.style.display = "block";
  clearTimeout(toast._t);
  toast._t = setTimeout(()=> t.style.display="none", 2200);
}
function normalizeTag(t){
  return (t||"").trim().toLowerCase().replace(/\s+/g,"-");
}
function getAllCategories(){
  const set = new Set(posts.map(p=>p.category).filter(Boolean));
  return Array.from(set).sort((a,b)=> a.localeCompare(b, "ar"));
}
function getAllTags(){
  const m = new Map();
  for(const p of posts){
    for(const t of (p.tags||[])){
      m.set(t, (m.get(t)||0)+1);
    }
  }
  return m;
}
function getFiltered(){
  let arr = posts.slice();

  if(state.q){
    const q = state.q.toLowerCase();
    arr = arr.filter(p=>{
      const hay = (p.title+" "+p.body+" "+(p.category||"")+" "+(p.tags||[]).join(" ")).toLowerCase();
      return hay.includes(q);
    });
  }
  if(state.category){
    arr = arr.filter(p=> (p.category||"") === state.category);
  }
  if(state.tag){
    arr = arr.filter(p=> (p.tags||[]).includes(state.tag));
  }

  if(state.sort === "newest") arr.sort((a,b)=> (b.createdAt||0) - (a.createdAt||0));
  if(state.sort === "oldest") arr.sort((a,b)=> (a.createdAt||0) - (b.createdAt||0));
  if(state.sort === "title")  arr.sort((a,b)=> (a.title||"").localeCompare(b.title||"", "ar"));

  return arr;
}
function setTheme(next){
  document.documentElement.setAttribute("data-theme", next);
  localStorage.setItem(KEY_THEME, next);
}
function initTheme(){
  const t = localStorage.getItem(KEY_THEME) || "dark";
  setTheme(t);
}

/* =========================
   Rendering
========================= */
function renderFilters(){
  // category select
  const catSel = document.getElementById("category");
  const cats = getAllCategories();
  catSel.innerHTML = `<option value="">ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>` + cats.map(c=>`<option ${c===state.category?"selected":""} value="${escapeHtml(c)}">${escapeHtml(c)}</option>`).join("");

  // tag chips (top 10 by frequency)
  const tagMap = getAllTags();
  const sortedTags = Array.from(tagMap.entries()).sort((a,b)=> b[1]-a[1]).slice(0, 12);
  const tagChips = document.getElementById("tagChips");
  tagChips.innerHTML = `
    <span class="chip ${state.tag===""?"active":""}" data-tag="">Ø§Ù„ÙƒÙ„</span>
    ${sortedTags.map(([t,n])=> `<span class="chip ${t===state.tag?"active":""}" data-tag="${escapeHtml(t)}">#${escapeHtml(t)} <span style="opacity:.7">(${n})</span></span>`).join("")}
  `;

  // active filters label
  const af = [];
  if(state.q) af.push(`Ø¨Ø­Ø«: "${state.q}"`);
  if(state.category) af.push(`ØªØµÙ†ÙŠÙ: ${state.category}`);
  if(state.tag) af.push(`ØªØ§Øº: #${state.tag}`);
  document.getElementById("activeFilters").textContent = af.length ? af.join(" â€¢ ") : "Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙ„Ø§ØªØ± Ù†Ø´Ø·Ø©";
}

function renderSidebar(){
  // latest
  const latest = posts.slice().sort((a,b)=> (b.createdAt||0)-(a.createdAt||0)).slice(0,6);
  document.getElementById("latest").innerHTML = latest.map(p=>`
    <div class="side-item">
      <a href="#post=${encodeURIComponent(p.id)}">${escapeHtml(p.title)}</a>
      <span>${fmtDate(p.createdAt)}</span>
    </div>
  `).join("");

  // category chips
  const cats = getAllCategories();
  const catChips = document.getElementById("catChips");
  catChips.innerHTML = cats.map(c=>`
    <span class="chip ${c===state.category?"active":""}" data-cat="${escapeHtml(c)}">${escapeHtml(c)}</span>
  `).join("") || `<div class="hint">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØµÙ†ÙŠÙØ§Øª Ø¨Ø¹Ø¯.</div>`;

  // top tags chips
  const tagMap = getAllTags();
  const top = Array.from(tagMap.entries()).sort((a,b)=> b[1]-a[1]).slice(0, 18);
  document.getElementById("topTags").innerHTML = top.map(([t,n])=>`
    <span class="chip ${t===state.tag?"active":""}" data-tag="${escapeHtml(t)}">#${escapeHtml(t)} <span style="opacity:.7">(${n})</span></span>
  `).join("") || `<div class="hint">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ§ØºØ§Øª Ø¨Ø¹Ø¯.</div>`;
}

function renderList(){
  const wrap = document.getElementById("posts");
  const pager = document.getElementById("pager");
  const list = getFiltered();

  // pagination
  const total = list.length;
  const pages = Math.max(1, Math.ceil(total / state.perPage));
  state.page = Math.min(state.page, pages);
  const start = (state.page-1)*state.perPage;
  const slice = list.slice(start, start + state.perPage);

  document.getElementById("count").textContent = `${total} Ù…Ù‚Ø§Ù„`;

  wrap.innerHTML = slice.map(p=>{
    const excerpt = (p.body||"").trim().slice(0, 140) + ((p.body||"").length > 140 ? "â€¦" : "");
    return `
      <article class="post">
        <div class="meta">
          <span>ğŸ“ ${escapeHtml(p.category||"Ø¨Ø¯ÙˆÙ† ØªØµÙ†ÙŠÙ")}</span>
          <span>ğŸ—“ï¸ ${fmtDate(p.createdAt)}</span>
          <span>ğŸ”— <a href="#post=${encodeURIComponent(p.id)}" style="text-decoration:underline;color:inherit;">Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù‚Ø§Ù„</a></span>
        </div>
        <h3 class="title"><a href="#post=${encodeURIComponent(p.id)}">${escapeHtml(p.title)}</a></h3>
        <p class="excerpt">${escapeHtml(excerpt)}</p>
        <div class="row">
          ${(p.tags||[]).slice(0,8).map(t=>`<span class="tag">#${escapeHtml(t)}</span>`).join(" ")}
        </div>
        <div class="post-actions">
          <button class="btn" data-open="${escapeHtml(p.id)}">Ù‚Ø±Ø§Ø¡Ø©</button>
          <button class="btn" data-edit="${escapeHtml(p.id)}">ØªØ¹Ø¯ÙŠÙ„</button>
          <button class="btn danger" data-del="${escapeHtml(p.id)}">Ø­Ø°Ù</button>
        </div>
      </article>
    `;
  }).join("") || `<div class="hint">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬. Ø¬Ø±Ù‘Ø¨ ØªØºÙŠÙŠØ± Ø§Ù„Ø¨Ø­Ø« Ø£Ùˆ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙÙ„Ø§ØªØ±.</div>`;

  pager.innerHTML = `
    <button class="btn" ${state.page<=1?"disabled":""} data-page="prev">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
    <span class="pageinfo">ØµÙØ­Ø© ${state.page} Ù…Ù† ${pages}</span>
    <button class="btn" ${state.page>=pages?"disabled":""} data-page="next">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `;
}

function openReader(id){
  const p = posts.find(x=>x.id===id);
  if(!p){ toast("Ø§Ù„Ù…Ù‚Ø§Ù„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯."); location.hash = ""; return; }

  state.mode = "reader";
  state.currentId = id;

  document.getElementById("list").style.display = "none";
  document.getElementById("reader").style.display = "block";

  document.getElementById("readerMeta").innerHTML =
    `<span>ğŸ“ ${escapeHtml(p.category||"Ø¨Ø¯ÙˆÙ† ØªØµÙ†ÙŠÙ")}</span>
     <span>ğŸ—“ï¸ ${fmtDate(p.createdAt)}</span>`;

  document.getElementById("readerTitle").textContent = p.title || "";
  document.getElementById("readerBody").textContent = p.body || "";

  const tagsWrap = document.getElementById("readerTags");
  tagsWrap.innerHTML = (p.tags||[]).map(t=> `<span class="chip" data-tag="${escapeHtml(t)}">#${escapeHtml(t)}</span>`).join("");

  // share links
  const url = location.origin + location.pathname + "#post=" + encodeURIComponent(p.id);
  document.getElementById("shareX").href = "https://twitter.com/intent/tweet?text=" + encodeURIComponent(p.title) + "&url=" + encodeURIComponent(url);
  document.getElementById("shareFB").href = "https://www.facebook.com/sharer/sharer.php?u=" + encodeURIComponent(url);
  document.getElementById("shareWA").href = "https://wa.me/?text=" + encodeURIComponent(p.title + " " + url);

  renderComments();
}

function closeReader(){
  state.mode = "list";
  state.currentId = null;
  document.getElementById("reader").style.display = "none";
  document.getElementById("list").style.display = "block";
}

function renderComments(){
  const id = state.currentId;
  const list = (commentsMap[id] || []).slice().sort((a,b)=> (b.at||0)-(a.at||0));
  const wrap = document.getElementById("commentList");
  wrap.innerHTML = list.map(c=>`
    <div class="comment">
      <div class="cmeta">
        <span>ğŸ‘¤ ${escapeHtml(c.name||"Ù…Ø¬Ù‡ÙˆÙ„")}</span>
        <span>${fmtDate(c.at)}</span>
      </div>
      <p>${escapeHtml(c.text||"")}</p>
    </div>
  `).join("") || `<div class="hint">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¨Ø¹Ø¯. ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠØ¹Ù„Ù‚!</div>`;
}

/* =========================
   Modal (New/Edit)
========================= */
function openModal(mode, id=null){
  const backdrop = document.getElementById("modalBackdrop");
  const mt = document.getElementById("modalTitle");
  const fCategory = document.getElementById("fCategory");
  const cats = getAllCategories();

  fCategory.innerHTML =
    `<option value="">Ø§Ø®ØªØ± ØªØµÙ†ÙŠÙÙ‹Ø§</option>` +
    cats.map(c=>`<option value="${escapeHtml(c)}">${escapeHtml(c)}</option>`).join("");

  if(mode==="new"){
    state.editingId = null;
    mt.textContent = "Ù…Ù‚Ø§Ù„ Ø¬Ø¯ÙŠØ¯";
    document.getElementById("fTitle").value = "";
    document.getElementById("fCategory").value = "";
    document.getElementById("fCategoryNew").value = "";
    document.getElementById("fTags").value = "";
    document.getElementById("fCover").value = "";
    document.getElementById("fBody").value = "";
  }else{
    const p = posts.find(x=>x.id===id);
    if(!p){ toast("ØªØ¹Ø°Ø± ÙØªØ­ Ø§Ù„Ù…Ù‚Ø§Ù„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„."); return; }
    state.editingId = id;
    mt.textContent = "ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„";
    document.getElementById("fTitle").value = p.title || "";
    document.getElementById("fCategory").value = p.category || "";
    document.getElementById("fCategoryNew").value = "";
    document.getElementById("fTags").value = (p.tags||[]).join(", ");
    document.getElementById("fCover").value = p.cover || "";
    document.getElementById("fBody").value = p.body || "";
  }

  backdrop.style.display = "flex";
}
function closeModal(){
  document.getElementById("modalBackdrop").style.display = "none";
}
function saveFromModal(){
  const title = document.getElementById("fTitle").value.trim();
  const catSel = document.getElementById("fCategory").value.trim();
  const catNew = document.getElementById("fCategoryNew").value.trim();
  const category = catNew || catSel || "Ø¨Ø¯ÙˆÙ† ØªØµÙ†ÙŠÙ";
  const tags = document.getElementById("fTags").value.split(",").map(normalizeTag).filter(Boolean);
  const cover = document.getElementById("fCover").value.trim();
  const body = document.getElementById("fBody").value.trim();

  if(!title || !body){ toast("Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ Ù…Ø·Ù„ÙˆØ¨Ø§Ù†."); return; }

  if(state.editingId){
    const idx = posts.findIndex(p=>p.id===state.editingId);
    if(idx>=0){
      posts[idx] = { ...posts[idx], title, category, tags, cover, body };
    }
    toast("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù‚Ø§Ù„ âœ…");
  }else{
    const p = { id: cryptoRandomId(), title, category, tags, cover, body, createdAt: Date.now() };
    posts.push(p);
    toast("ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‚Ø§Ù„ âœ…");
  }

  savePosts(posts);
  closeModal();
  hydrate(); // rerender everything
}
function previewModal(){
  const title = document.getElementById("fTitle").value.trim() || "(Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†)";
  const body = document.getElementById("fBody").value.trim() || "(Ø¨Ø¯ÙˆÙ† Ù…Ø­ØªÙˆÙ‰)";
  alert("Ù…Ø¹Ø§ÙŠÙ†Ø© Ø³Ø±ÙŠØ¹Ø©:\n\n" + title + "\n\n" + body.slice(0, 500) + (body.length>500 ? "â€¦" : ""));
}

/* =========================
   Delete
========================= */
function deletePost(id){
  const p = posts.find(x=>x.id===id);
  if(!p) return;

  if(!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù‚Ø§Ù„ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹.")) return;
  posts = posts.filter(x=>x.id!==id);
  savePosts(posts);

  // remove its comments
  delete commentsMap[id];
  saveComments(commentsMap);

  toast("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù‚Ø§Ù„ ğŸ—‘ï¸");
  if(state.currentId===id) closeReader();
  hydrate();
}

/* =========================
   Comments
========================= */
function addComment(){
  const id = state.currentId;
  if(!id) return;

  const name = document.getElementById("cName").value.trim() || "Ù…Ø¬Ù‡ÙˆÙ„";
  const email = document.getElementById("cEmail").value.trim();
  const text = document.getElementById("cText").value.trim();

  if(!text){ toast("Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ù‹Ø§ Ø£ÙˆÙ„Ø§Ù‹."); return; }

  const entry = { name, email, text, at: Date.now() };
  commentsMap[id] = commentsMap[id] || [];
  commentsMap[id].push(entry);
  saveComments(commentsMap);

  document.getElementById("cText").value = "";
  toast("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ âœ…");
  renderComments();
}

/* =========================
   Import/Export
========================= */
function exportJSON(e){
  e.preventDefault();
  const data = { posts, commentsMap, exportedAt: Date.now() };
  const blob = new Blob([JSON.stringify(data, null, 2)], {type:"application/json"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "blog-export.json";
  a.click();
  URL.revokeObjectURL(url);
}
async function importJSON(file){
  try{
    const text = await file.text();
    const data = JSON.parse(text);
    if(!data.posts || !Array.isArray(data.posts)) throw new Error("ØµÙŠØºØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©");
    posts = data.posts;
    commentsMap = data.commentsMap || {};
    savePosts(posts);
    saveComments(commentsMap);
    toast("ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ âœ…");
    hydrate();
  }catch(err){
    toast("ÙØ´Ù„ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯: " + (err?.message || "Ø®Ø·Ø£"));
  }
}

/* =========================
   Router (hash)
========================= */
function handleHash(){
  const hash = location.hash || "";
  const m = hash.match(/#post=([^&]+)/);
  if(m){
    const id = decodeURIComponent(m[1]);
    openReader(id);
  }else{
    closeReader();
  }
}

/* =========================
   Hydrate (render all)
========================= */
function hydrate(){
  // ensure unique IDs
  posts = (posts||[]).filter(Boolean);

  renderFilters();
  renderSidebar();
  renderList();

  // fill modal category select each time
  // also update reader tags chip click
}

/* =========================
   Events
========================= */
function bind(){
  // year
  document.getElementById("year").textContent = new Date().getFullYear();

  // theme
  initTheme();
  document.getElementById("btnTheme").addEventListener("click", ()=>{
    const cur = document.documentElement.getAttribute("data-theme") || "dark";
    setTheme(cur==="dark

